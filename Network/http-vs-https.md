# HTTP vs HTTPS

## TOC

> - [HTTP 란?](#http-란)
>   - [주요 특징](#주요-특징)
>   - [통신 과정](#통신-과정)

---

## HTTP 란?

> ### TLTR;
>
> 1. 클라이언트-서버 통신
> 2. Stateless
> 3. Connectionless

HTTP(Hyper Text Transfer Protocol)란 서버/클라이언트 모델을 따라 데이터를 주고 받기 위한 프로토콜이다.

즉, HTTP는 인터넷에서 HTML을 교환하기 위한 통신 규약으로, 80번 포트를 사용하고 있다. 따라서 HTTP 서버가 80번 포트에서 요청을 기다리고 있으며, 클라이언트는 80번 포트로 요청을 보내게 된다.

- 현재는 html 문서 형식 뿐 아니라 json, image 파일 등을 전송할 수 있다.

### 주요 특징

주요 특징으로는, **클라이언트-서버 통신**, **Stateless**, **Connectionless** 가 있다.

**클라이언트-서버 통신**, 클라이언트는 서버에 리소스를 요청하고, 서버는 요청에 따라 response를 전송한다. 클라이언트에서 서버로 단방향 통신이 이루어진다.

**Stateless**, 서버는 클라이언트의 이전 상태를 보존하지 않는다. 따라서, 서버는 여러 클라이언트에 대응할 수 있고, 클라이언트도 같은 서버가 유지될 필요가 없다.

**Connectionless**, 클라이언트는 서버에게 response를 받은 이후 TCP/IP 연결 상태를 끊어버린다. HTTP에서는 연결을 유지하지 않는 것을 기본으로 하고, 필요에 따라 keep alive 옵션을 통해 연결 상태를 일정 시간 유지할 수 있다.

### 통신 과정

> 브라우저 주소창에 URL을 입력하면 어떤 일이 일어날까?

1.  사용자가 주소창에 URL을 입력 후 엔터를 친다.
2.  [브라우저에 캐싱된 DNS 기록 조회](#브라우저에-캐싱된-dns-기록-조회)
3.  [요청한 URL이 캐시에 없는 경우, ISP의 DNS 서버에서 다른 DNS를 조회하여 IP 탐색](#요청한-url이-캐시에-없는-경우-isp의-dns-서버에서-다른-dns를-조회하여-ip-탐색)
4.  [브라우저가 해당 서버와 TCP 연결 시작](#브라우저가-해당-서버와-tcp-연결-시작)
5.  브라우저가 웹서버에 HTTP 요청 전송
6.  서버가 HTTP 응답 전송
7.  브라우저가 HTML 컨텐츠를 노출
8.  [연결 종료](#연결-종료)

### 브라우저에 캐싱된 DNS 기록 조회

- 도메인 주소로 입력했을 때, IP를 가져올 수 있도록 DNS(Domain Name System) 서버를 이용한다.
- DNS는 Doman Name System의 약자로 URL의 이름과 IP주소를 저장하고 있는 데이터베이스이다.

#### 요청한 URL이 캐시에 없는 경우, ISP의 DNS 서버에서 다른 DNS를 조회하여 IP 탐색

- 캐시에 요청한 URL의 IP 정보가 없으면, ISP는 DNS 서버들을 검색해 해당 도메인의 IP 주소를 검색한다.
- ISP는 인터넷 서비스 공급자의 약자이다. ex) SK, LG, KT 등

#### 브라우저가 해당 서버와 TCP 연결 시작

- TCP 3-way handshake 과정을 통해 클라이언트와 서버가 연결된다.
- 정확한 전송을 보장하기 위해 세션을 수립하는 과정을 의미한다.

> TCP 3-way handshake 과정
>
> - 클라이언트 > 서버: 접속을 요청하는 SYN flag가 설정된 패킷 전송(클라이언트 상태: SYN_SENT)
> - 서버 > 클라이언트: 요청을 수락하는 ACK flag가 설정된 패킷과 SYN flag가 설정된 패킷 전송(서버 상태: SYN_RECIEVED)
> - 클라이언트 > 서버: 요청을 수락하는 ACK flag가 설정된 패킷 전송(서버 상태: EST_ABLISHED)
>
> 이로써 연결 완료되고, 이후부터는 데이터 송수신이 가능하다.

#### 연결 종료

- 세션을 종료하기 위해서는 TCP 4-way handshake 과정이 이루어진다.

> TCP 4-way handshake 과정
>
> - 클라이언트 > 서버: 연결 종료를 요청하는 FIN flag가 설정된 패킷 전송(클라이언트 상태: FIN_WAIT_1)
> - 서버 > 클라이언트: 요청을 수락하는 ACK flag가 설정된 패킷 전송 + 자신의 통신이 끝날때까지 대기(클라이언트 상태: FIN_WAIT_2, 서버 상태: CLOSE_WAIT)
> - 서버 > 클라이언트: 자신의 통신이 종료되면 FIN flag가 설정된 패킷 전송(클라이언트 상태: TIME_WAIT, 서버 상태: LAST_ACK)
> - 클라이언트 > 서버: 확인했다는 ACK flag가 설정된 패킷 전송
>
> 이로써 연결 종료된다.
